@{
    Layout = "~/Views/Shared/_LayoutInterno.cshtml";
}
<link href="~/Static/css/Principal.css" rel="stylesheet" />

<!-- HERO -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card border-0 bg-gradient-success" style="background: linear-gradient(135deg,#0f766e 0%, #134e4a 100%);">
            <div class="card-body d-flex flex-wrap align-items-center justify-content-between">
                <div>
                    <h4 class="text-white mb-1">Bienvenido a Mundo Animal Vet 🐶🐱</h4>
                    <p class="text-white opacity-8 mb-0">
                        Plataforma para gestionar clientes, mascotas, citas, inventario y tienda.
                    </p>
                </div>
                <div class="d-flex gap-3 align-items-center mt-3 mt-md-0">
                    <a href="@Url.Action("AgregarCita", "Cita")" class="btn btn-light text-dark btn-sm">Registrar cita</a>
                    <a href="@Url.Action("AgregarMascota", "Mascota")" class="btn btn-outline-light btn-sm">Agregar mascota</a>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- CONTENIDO PRINCIPAL: CITAS + ALERTAS + TIENDA -->
<div class="row">
    <!-- Próximas citas -->
    <div class="col-lg-7 mb-4">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="mb-0">Próximas citas</h6>
                <a href="@Url.Action("VerCitas", "Cita")" class="text-sm text-primary">Ver calendario</a>
            </div>

            <div class="card-body p-0">
                <ul class="list-group list-group-flush">
                    @{
                        var proximas = ViewBag.ProximasCitas as IEnumerable<KN_Proyecto_progra_avanzada.Models.Cita>;
                    }

                    @if (proximas != null && proximas.Any())
                    {
                        foreach (var c in proximas)
                        {
                            var badgeClass = "bg-secondary";
                            var badgeText = c.Estado;

                            if (c.Estado == "Programada")
                            {
                                badgeClass = "bg-warning text-dark";
                                badgeText = "Pendiente";
                            }
                            else if (c.Estado == "Completada")
                            {
                                badgeClass = "bg-success";
                                badgeText = "Confirmada";
                            }
                            else if (c.Estado == "Urgente")
                            {
                                badgeClass = "bg-danger";
                                badgeText = "Urgente";
                            }

                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <h6 class="mb-0">
                                        @c.FechaCita.ToString("hh:mm tt") - @c.Motivo
                                    </h6>
                                    <p class="text-xs text-secondary mb-0">
                                        Mascota: @c.NombreMascota · Cliente: @c.NombreCliente
                                    </p>
                                </div>
                                <span class="badge @badgeClass">@badgeText</span>
                            </li>
                        }

                        <li class="list-group-item text-center">
                            <a href="@Url.Action("VerCitas", "Cita")" class="text-sm text-primary">
                                Ver todas las citas del día
                            </a>
                        </li>
                    }
                    else
                    {
                        <li class="list-group-item text-center text-muted">
                            No hay citas programadas para hoy.
                        </li>
                    }
                </ul>
            </div>
        </div>
    </div>

    <!-- Alertas / Inventario / Recordatorios -->
    <div class="col-lg-5 mb-4">
        <div class="card mb-4">
            <div class="card-header pb-0">
                <h6>Alertas del sistema</h6>
            </div>
            <div class="card-body">
                <div class="alert alert-warning d-flex align-items-center" role="alert">
                    <span class="material-symbols-rounded me-2">inventory_2</span>
                    Vacuna antirrábica - stock bajo. Revisar inventario.
                </div>
                <div class="alert alert-info d-flex align-items-center" role="alert">
                    <span class="material-symbols-rounded me-2">pets</span>
                    2 mascotas requieren control post-operatorio hoy.
                </div>
                <div class="alert alert-success d-flex align-items-center" role="alert">
                    <span class="material-symbols-rounded me-2">shopping_bag</span>
                    Nueva orden creada en la tienda en línea.
                </div>
            </div>
        </div>

        <!-- Módulo pequeño de tienda -->
        <div class="card">
            <div class="card-header pb-0 d-flex justify-content-between align-items-center">
                <h6>Tienda en línea</h6>
                <a href="@Url.Action("VerCatalogo", "Catalogo")" class="text-sm text-primary">Ver más</a>
            </div>
            <div class="card-body">
                @{
                    var productos = ViewBag.ProductosTienda as IEnumerable<KN_Proyecto_progra_avanzada.EF.tbCatalogo>;
                }

                @if (productos != null && productos.Any())
                {
                    foreach (var prod in productos)
                    {
                        <div class="d-flex gap-3 mb-3 align-items-center">
                            <div class="flex-shrink-0">
                                @if (!string.IsNullOrEmpty(prod.Imagen))
                                {
                                    <img src="@prod.Imagen"
                                         class="rounded"
                                         style="width:80px;height:80px;object-fit:cover;"
                                         alt="@prod.Nombre" />
                                }
                                else
                                {
                                    <div class="bg-gray-200 rounded d-flex justify-content-center align-items-center"
                                         style="width:80px;height:80px;">
                                        <i class="material-symbols-rounded">shopping_bag</i>
                                    </div>
                                }
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="mb-1">@prod.Nombre</h6>
                                <p class="text-xs text-secondary mb-1">
                                    @(!string.IsNullOrEmpty(prod.Descripcion) ? prod.Descripcion : "Producto veterinaria")
                                </p>
                                <span class="badge bg-success mb-2">₡ @prod.Precio</span><br />
                                <a href="#" class="btn btn-sm btn-primary">Agregar al carrito</a>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <p class="text-sm text-secondary mb-0">No hay productos cargados en el catálogo.</p>
                }
            </div>
        </div>

    </div>
</div>
